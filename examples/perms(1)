perms(l) := [l] if len(l) = 1 else with insert(l, a, i): l[:i]+[a]+l[i:]: with first=car(l), rest=cdr(l): \
with subperms=perms(rest): sum([[insert(p, first, i) for i in enum(l)] for p in subperms])

#TEST
perms([1,2,3])