{"calc_parse": [[["f[x] @g[x,x] = this"], [["BIND", ["FUNC", ["NAME", "f"], ["FORM", ["x"], [], null]], ["AT:SEQ", ["NAME", "g"], ["VAL_LST", ["NAME", "x"], ["NAME", "x"]]], ["NAME", "this"]], ""]], [["a=3;a"], [["LINE", ["BIND", ["NAME", "a"], ["REAL", "3"]], ["NAME", "a"]], ""]], [["a=3; a"], [["LINE", ["BIND", ["NAME", "a"], ["REAL", "3"]], ["NAME", "a"]], ""]], [["a=(x=2,y=3); f[x]=@a x+y; f[9]"], [["LINE", ["BIND", ["NAME", "a"], ["DICT", ["BIND", ["NAME", "x"], ["REAL", "2"]], ["BIND", ["NAME", "y"], ["REAL", "3"]]]], ["BIND", ["FUNC", ["NAME", "f"], ["FORM", ["x"], [], null]], ["CLOSURE", ["AT:NAME", "a"], ["DELAY:SEQ", ["NAME", "x"], ["BOP", "+"], ["NAME", "y"]]]], ["SEQ", ["NAME", "f"], ["VAL_LST", ["REAL", "9"]]]], ""]], [["f@e=10"], [["BIND", ["NAME", "f"], ["AT:NAME", "e"], ["REAL", "10"]], ""]], [["f[x].y"], [["SEQ", ["NAME", "f"], ["VAL_LST", ["NAME", "x"]], ["ATTR", "y"]], ""]], [["x . y"], [["SEQ", ["NAME", "x"], ["BOP", "."], ["NAME", "y"]], ""]], [["3"], [["REAL", "3"], ""]], [["x"], [["NAME", "x"], ""]], [["2.*4"], [["SEQ", ["REAL", "2"], ["BOP", ".*"], ["REAL", "4"]], ""]], [["2.4e-18"], [["REAL", "2.4", "-18"], ""]], [["2.4-1e-10I"], [["COMPLEX", ["REAL", "2.4"], "-", ["REAL", "1", "-10"]], ""]], [["1+2*3"], [["SEQ", ["REAL", "1"], ["BOP", "+"], ["REAL", "2"], ["BOP", "*"], ["REAL", "3"]], ""]], [["3!+4"], [["SEQ", ["REAL", "3"], ["ROP", "!"], ["BOP", "+"], ["REAL", "4"]], ""]], [["[]"], [["VAL_LST"], ""]], [["[2]"], [["VAL_LST", ["REAL", "2"]], ""]], [["[3, 4, 6]"], [["VAL_LST", ["REAL", "3"], ["REAL", "4"], ["REAL", "6"]], ""]], [["f[]"], [["SEQ", ["NAME", "f"], ["VAL_LST"]], ""]], [["x = 5"], [["BIND", ["NAME", "x"], ["REAL", "5"]], ""]], [["x = 3 * f[3, 5, 7]"], [["BIND", ["NAME", "x"], ["SEQ", ["REAL", "3"], ["BOP", "*"], ["NAME", "f"], ["VAL_LST", ["REAL", "3"], ["REAL", "5"], ["REAL", "7"]]]], ""]], [["f[x]=1/x"], [["BIND", ["FUNC", ["NAME", "f"], ["FORM", ["x"], [], null]], ["SEQ", ["REAL", "1"], ["BOP", "/"], ["NAME", "x"]]], ""]], [["f[]=1"], [["BIND", ["FUNC", ["NAME", "f"], ["FORM", [], [], null]], ["REAL", "1"]], ""]], [["f[x, y]=x*y"], [["BIND", ["FUNC", ["NAME", "f"], ["FORM", ["x", "y"], [], null]], ["SEQ", ["NAME", "x"], ["BOP", "*"], ["NAME", "y"]]], ""]], [["[1,2;3,4]"], [["VAL_LST", ["VAL_LST", ["REAL", "1"], ["REAL", "2"]], ["VAL_LST", ["REAL", "3"], ["REAL", "4"]]], ""]], [["when(1: 2, 3: 4, 5)"], [["WHEN", ["CASE", ["REAL", "1"], ["REAL", "2"]], ["CASE", ["REAL", "3"], ["REAL", "4"]], ["REAL", "5"]], ""]], [["[x, y] => x+y"], [["MAP", ["FORM", ["x", "y"], [], null], ["DELAY:SEQ", ["NAME", "x"], ["BOP", "+"], ["NAME", "y"]]], ""]], [["[]=>1"], [["MAP", ["FORM", [], [], null], ["DELAY:REAL", "1"]], ""]], [["[a, r~] => [a, r~]"], [["MAP", ["FORM", ["a"], [], "r"], ["DELAY:VAL_LST", ["NAME", "a"], ["SEQ", ["NAME", "r"], ["ROP", "~"]]]], ""]], [["(x=2)"], [["DICT", ["BIND", ["NAME", "x"], ["REAL", "2"]]], ""]], [["(x=1, y=2) x+y"], [["CLOSURE", ["DICT", ["BIND", ["NAME", "x"], ["REAL", "1"]], ["BIND", ["NAME", "y"], ["REAL", "2"]]], ["DELAY:SEQ", ["NAME", "x"], ["BOP", "+"], ["NAME", "y"]]], ""]], [["l[x:2]"], [["SEQ", ["NAME", "l"], ["IDC_LST", ["SLICE", ["NAME", "x"], ["REAL", "2"]]]], ""]], [["[x for x in [1,2,3]]"], [["GEN_LST", ["NAME", "x"], ["CONSTR", ["PAR", "x"], ["VAL_LST", ["REAL", "1"], ["REAL", "2"], ["REAL", "3"]]]], ""]], [["f[1:]"], [["SEQ", ["NAME", "f"], ["IDC_LST", ["SLICE", ["REAL", "1"], ["EMPTY"]]]], ""]], [["m[1:, :-1]"], [["SEQ", ["NAME", "m"], ["IDC_LST", ["SLICE", ["REAL", "1"], ["EMPTY"]], ["SLICE", ["EMPTY"], ["SEQ", ["LOP", "-"], ["REAL", "1"]]]]], ""]], [["dir x"], [["DIR", ["NAME", "x"]], ""]], [["del x, y"], [["DEL", ["NAME", "x"], ["NAME", "y"]], ""]], [["config LATEX on"], [["LATEX", "on"], ""]], [["import gauss_jordan -t"], [["IMPORT", "gauss_jordan"], " -t"]], [["f[x] = x;  # the semicolon hides the output"], [["LINE", ["BIND", ["FUNC", ["NAME", "f"], ["FORM", ["x"], [], null]], ["NAME", "x"]], ["EMPTY"]], "# the semicolon hides the output"]], [["2..-3"], [["SEQ", ["REAL", "2"], ["BOP", ".."], ["LOP", "-"], ["REAL", "3"]], ""]], [["[a,b~]::[1,2,3]"], [["MATCH", ["FORM", ["a"], [], "b"], ["VAL_LST", ["REAL", "1"], ["REAL", "2"], ["REAL", "3"]]], ""]], [["x .f"], [["FIELD", ["NAME", "x"], ["ATTR", "f"]], ""]], [["f.a.b[x] = f[x]"], [["DEF", ["FIELD", ["NAME", "f"], ["NAME", "a"]], ["BIND", ["FUNC", ["NAME", "b"], ["FORM", ["x"], [], null]], ["SEQ", ["NAME", "f"], ["VAL_LST", ["NAME", "x"]]]]], ""]], [["f[x, y, z=0, w~] = 1"], [["BIND", ["FUNC", ["NAME", "f"], ["FORM", ["x", "y"], [[["NAME", "z"], ["REAL", "0"]]], "w"]], ["REAL", "1"]], ""]], [["[3, 4] if x==3 else (x=2, y=3) x+y"], [["IF_ELSE", ["VAL_LST", ["REAL", "3"], ["REAL", "4"]], ["SEQ", ["NAME", "x"], ["BOP", "=="], ["REAL", "3"]], ["CLOSURE", ["DICT", ["BIND", ["NAME", "x"], ["REAL", "2"]], ["BIND", ["NAME", "y"], ["REAL", "3"]]], ["DELAY:SEQ", ["NAME", "x"], ["BOP", "+"], ["NAME", "y"]]]], ""]], [["[x+f[f[3*6]^2], [2, 6], g[3, 6]]"], [["VAL_LST", ["SEQ", ["NAME", "x"], ["BOP", "+"], ["NAME", "f"], ["VAL_LST", ["SEQ", ["NAME", "f"], ["VAL_LST", ["SEQ", ["REAL", "3"], ["BOP", "*"], ["REAL", "6"]]], ["BOP", "^"], ["REAL", "2"]]]], ["VAL_LST", ["REAL", "2"], ["REAL", "6"]], ["SEQ", ["NAME", "g"], ["VAL_LST", ["REAL", "3"], ["REAL", "6"]]]], ""]], [["[x, [y, z~], w~] => [x+y+z, w]"], [["MAP", ["FORM", ["x"], [], "w"], ["DELAY:VAL_LST", ["SEQ", ["NAME", "x"], ["BOP", "+"], ["NAME", "y"], ["BOP", "+"], ["NAME", "z"]], ["NAME", "w"]]], ""]], [["(x*('y+2))/3"], [["SEQ", ["SEQ", ["NAME", "x"], ["BOP", "*"], ["SEQ", ["SYM", "y"], ["BOP", "+"], ["REAL", "2"]]], ["BOP", "/"], ["REAL", "3"]], ""]], [["[x+y for x in 1..10 if x%2 for y in range[x]]"], [["GEN_LST", ["SEQ", ["NAME", "x"], ["BOP", "+"], ["NAME", "y"]], ["CONSTR", ["PAR", "x"], ["SEQ", ["REAL", "1"], ["BOP", ".."], ["REAL", "10"]], ["SEQ", ["NAME", "x"], ["BOP", "%"], ["REAL", "2"]]], ["CONSTR", ["PAR", "y"], ["SEQ", ["NAME", "range"], ["VAL_LST", ["NAME", "x"]]]]], ""]], [["'[a,[x, `y],`b]"], [["SYM_LST", ["SYM", "a"], ["SYM_LST", ["SYM", "x"], ["NAME", "y"]], ["NAME", "b"]], ""]], [["a . b"], [["SEQ", ["NAME", "a"], ["BOP", "."], ["NAME", "b"]], ""]], [["x : 2"], [["NAME", "x"], " : 2"]], [["(3"], [["EMPTY"], "(3"]], [["[3, f(4])"], [["EMPTY"], "[3, f(4])"]], [["f[3, [5]"], [["NAME", "f"], "[3, [5]"]], [["[2, 4] + [6, 7"], [["VAL_LST", ["REAL", "2"], ["REAL", "4"]], " + [6, 7"]], [["[a~, b~] => [a; b]"], [["VAL_LST", ["VAL_LST", ["SEQ", ["NAME", "a"], ["ROP", "~"]], ["SEQ", ["NAME", "b"], ["ROP", "~"]]]], " => [a; b]"]], [["[1,[1]~]"], [["VAL_LST", ["REAL", "1"], ["SEQ", ["VAL_LST", ["REAL", "1"]], ["ROP", "~"]]], ""]], [["'[a,`[b,c]]"], [["SYM_LST", ["SYM", "a"], ["VAL_LST", ["NAME", "b"], ["NAME", "c"]]], ""]], [["'[a,`[b,'[c,`d],d]]"], [["SYM_LST", ["SYM", "a"], ["VAL_LST", ["NAME", "b"], ["SYM_LST", ["SYM", "c"], ["NAME", "d"]], ["NAME", "d"]]], ""]], [["f x = 1"], [["BIND", ["FUNC", ["NAME", "f"], ["PAR", "x"]], ["REAL", "1"]], ""]], [["f[x]=x"], [["BIND", ["FUNC", ["NAME", "f"], ["FORM", ["x"], [], null]], ["NAME", "x"]], ""]], [["[[]]"], [["VAL_LST", ["VAL_LST"]], ""]], [["x::([a,b]::[2,3] a+b) 2*x"], [["CLOSURE", ["MATCH", ["PAR", "x"], ["CLOSURE", ["MATCH", ["FORM", ["a", "b"], [], null], ["VAL_LST", ["REAL", "2"], ["REAL", "3"]]], ["DELAY:SEQ", ["NAME", "a"], ["BOP", "+"], ["NAME", "b"]]]], ["DELAY:SEQ", ["REAL", "2"], ["BOP", "*"], ["NAME", "x"]]], ""]], [["(f[x]=x,g[y]=f[2*y])"], [["DICT", ["BIND", ["FUNC", ["NAME", "f"], ["FORM", ["x"], [], null]], ["NAME", "x"]], ["BIND", ["FUNC", ["NAME", "g"], ["FORM", ["y"], [], null]], ["SEQ", ["NAME", "f"], ["VAL_LST", ["SEQ", ["REAL", "2"], ["BOP", "*"], ["NAME", "y"]]]]]], ""]], [["[a,b]=[2,3]"], [["BIND", ["VARS", ["NAME", "a"], ["NAME", "b"]], ["VAL_LST", ["REAL", "2"], ["REAL", "3"]]], ""]], [["[a,b.c]=[3,5]"], [["VAL_LST", ["NAME", "a"], ["FIELD", ["NAME", "b"], ["ATTR", "c"]]], "=[3,5]"]], [["a-1"], [["SEQ", ["NAME", "a"], ["BOP", "-"], ["REAL", "1"]], ""]], [["0.5*2^2 + lg(100+10*90)"], [["SEQ", ["REAL", "0.5"], ["BOP", "*"], ["REAL", "2"], ["BOP", "^"], ["REAL", "2"], ["BOP", "+"], ["NAME", "lg"], ["SEQ", ["REAL", "100"], ["BOP", "+"], ["REAL", "10"], ["BOP", "*"], ["REAL", "90"]]], ""]], [["when(a:1,b:2,9)"], [["WHEN", ["CASE", ["NAME", "a"], ["REAL", "1"]], ["CASE", ["NAME", "b"], ["REAL", "2"]], ["REAL", "9"]], ""]], [["f[a=3]=0"], [["BIND", ["FUNC", ["NAME", "f"], ["FORM", [], [[["NAME", "a"], ["REAL", "3"]]], null]], ["REAL", "0"]], ""]], [["@a x+y"], [["CLOSURE", ["AT:NAME", "a"], ["DELAY:SEQ", ["NAME", "x"], ["BOP", "+"], ["NAME", "y"]]], ""]], [["f[x] = @g[x,0] 3a"], [["BIND", ["FUNC", ["NAME", "f"], ["FORM", ["x"], [], null]], ["CLOSURE", ["AT:SEQ", ["NAME", "g"], ["VAL_LST", ["NAME", "x"], ["REAL", "0"]]], ["DELAY:SEQ", ["REAL", "3"], ["NAME", "a"]]]], ""]]], "parse_grammar": [[["ALT", ", -"], [["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["MARK", ","]]], ["OP", "-"]]], ""]], [["DEF", "LIST    := %LST < \"[\" \"]\" ; %SEQ < , /.*/ > >"], [["DEF", ["OBJ", "LIST"], ":=", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["MACRO", "%LST", "<", ["ITEMS", ["ITEM", ["ATOM", ["STR", "\"[\""]]], ["ITEMS", ["ITEM", ["ATOM", ["STR", "\"]\""]]], ["ITEMS", ["ITEM", ["ATOM", ["MARK", ";"]]], ["ITEMS", ["ITEM", ["MACRO", "%SEQ", "<", ["ITEMS", ["ITEM", ["ATOM", ["MARK", ","]]], ["ITEMS", ["ITEM", ["ATOM", ["RE", "/.*/"]]]]], ">"]]]]]], ">"]]]]]], ""]], [["DEF", "EXP := LOCAL | LAMBDA | IF_ELSE | OP_SEQ"], [["DEF", ["OBJ", "EXP"], ":=", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "LOCAL"]]]]], "|", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "LAMBDA"]]]]], "|", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "IF_ELSE"]]]]], "|", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "OP_SEQ"]]]]]]]]]], ""]], [["DEF", "LC := ( BLIST | BIND * ) ? \"=>\" EXP"], [["DEF", ["OBJ", "LC"], ":=", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["GROUP", "(", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "BLIST"]]]]], "|", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "BIND"]]], ["OP", "*"]]]]], ")"]], ["OP", "?"]], ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["STR", "\"=>\""]]]], ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "EXP"]]]]]]]]], ""]], [["DEF", "%M < $A > := $A $A +"], [["DEF", ["MACRO", "%M", "<", ["VARS", ["VAR", "$A"]], ">"], ":=", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["VAR", "$A"]]]], ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["VAR", "$A"]]], ["OP", "+"]]]]]], ""]]], "refactor_tree": [[[["DEF", ["OBJ", "EXP"], ":=", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "LOCAL"]]]]], "|", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "LAMBDA"]]]]], "|", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "IF_ELSE"]]]]], "|", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "OP_SEQ"]]]]]]]]]]], ["DEF", ["OBJ", "EXP"], ":=", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "LOCAL"]]]]], "|", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "LAMBDA"]]]]], "|", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "IF_ELSE"]]]]], "|", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "OP_SEQ"]]]]]]]]]]], [[["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["GROUP", "(", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "BLIST"]]]]], "|", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "BIND"]]], ["OP", "*"]]]]], ")"]], ["OP", "?"]], ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["STR", "\"=>\""]]]], ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "EXP"]]]]]]]]], ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["GROUP", "(", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "BLIST"]]]]], "|", ["EXP", ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "BIND"]]], ["OP", "*"]]]]], ")"]], ["OP", "?"]], ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["STR", "\"=>\""]]]], ["ALT", ["ITEM_OP", ["ITEM", ["ATOM", ["OBJ", "EXP"]]]]]]]]]], "calc_grammar": [[[["LIST    := %LST < \"[\" \"]\" ; %SEQ < , /.*/ > >", "%LST < $OPN $CLS $SEP $ITM > := $OPN $CLS | $OPN $ITM ( $SEP $ITM ) * $CLS", "%SEQ < $SEP $ITM >           := $ITM ? ( $SEP $ITM ) *"]], {" ": "\\s*", "LIST": ["EXP", ["ALT", ["STR", "\"[\""], ["STR", "\"]\""]], ["ALT", ["STR", "\"[\""], ["ALT", ["ITEM_OP", ["RE", "/.*/"], ["OP", "?"]], ["ITEM_OP", ["ALT", ["MARK", ","], ["RE", "/.*/"]], ["OP", "*"]]], ["ITEM_OP", ["ALT", ["MARK", ";"], ["ALT", ["ITEM_OP", ["RE", "/.*/"], ["OP", "?"]], ["ITEM_OP", ["ALT", ["MARK", ","], ["RE", "/.*/"]], ["OP", "*"]]]], ["OP", "*"]], ["STR", "\"]\""]]]}]]}